//>>>>>>>>>>>>>>Курамшин Р.С. 20.07.2017 54-ФЗ
Процедура ПечатьЧека()
	
	Если ЧекПробитККМ = 1 Тогда
		Сообщить("По этому документу уже пробит чек!");
		Возврат;
	КонецЕсли;
	
	Если Безнал = 1 Тогда
		Сообщить("Оплачено как безнал!");
		Возврат;
	КонецЕсли;
	
	СписокТоваров = СоздатьОбъект("ТаблицаЗначений");
	СписокТоваров.НоваяКолонка("ТовНаим"   , "Строка");
	СписокТоваров.НоваяКолонка("Цена"      , "Число");
	СписокТоваров.НоваяКолонка("Количество", "Число");
	СписокТоваров.НоваяКолонка("Сумма"	   , "Число");
	СписокТоваров.НоваяКолонка("СтавкаНДС" , "Строка");
	
	
	ВыбратьСтроки();
	Пока ПолучитьСтроку() = 1 Цикл
		СписокТоваров.НоваяСтрока();
		СписокТоваров.ТовНаим    = Номенклатура.Наименование;
		СписокТоваров.Цена       = Цена;
		СписокТоваров.Количество = Количество; 
		СписокТоваров.Сумма		 = Сумма;
		СписокТоваров.СтавкаНДС = "none";
	КонецЦикла;
	
	ОплатаБезНал = 0;
	ПризнВозврата =	0;
	СуммаЧека = Итог("Сумма");
    Получено = СуммаЧека;
	КассирФИО = ПолноеИмяПользователя(); 
	
	Параметры = СоздатьОбъект("СписокЗначений");
	Параметры.Установить("Процесс"           , "печатать_чек");
	Параметры.Установить("СписокТоваров"     , СписокТоваров);
	Параметры.Установить("СуммаЧека"         , СуммаЧека);
	Параметры.Установить("Получено"          , Получено);
	Параметры.Установить("Возврат"           , ПризнВозврата);
	Параметры.Установить("КассирФИО" 		 , КассирФИО);
	Параметры.Установить("КонтактКлиента"    , КонтактКлиента);
	Параметры.Установить("БезНал"            , ОплатаБезНал);
		
	ОткрытьФормуМодально("Отчет", Параметры, КаталогИБ() + "ONLINE-54.ert");
	
	Если Параметры.Получить("Результат") = 1 Тогда
		ЧекПробитККМ=1;
		ПриЗаписиПерепроводить(0);
		Записать();
		ПриЗаписиПерепроводить(1);
	Иначе
		ЧекПробитККМ=0;
		Сообщить(Параметры.Получить("ОписаниеРезультата"));
	КонецЕсли;
	
КонецПроцедуры //ПечатьЧека()
//<<<<<<<<<<<<<<Курамшин Р.С. 20.07.2017 54-ФЗ